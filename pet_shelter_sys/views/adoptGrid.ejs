<html>
<head>
    <title><%= title %></title>
    <!-- Load icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Load Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Your Custom CSS -->
    <link rel='stylesheet' href='stylesheets/adoptGrid.css'>
</head>    

<body>
    <!-- NAVIGATION BAR -->
    <%- include('partials/nav.ejs', { activePage: 'home' }); %>

    <!-- MAIN CONTENT -->
    <main>
        <div class="sf_buttons">
            <!-- Search and filter buttons -->
            <div class="search_filt">
                <form id="search-form">
                    <input type="text" id="search-input" placeholder="Search by name, breed, or description..." name="search">
                    <button type="submit"><i class="fa fa-search"></i></button>
                </form>
            </div>

            <div class="dropdown">
                <button class="filter-btn">Filter <i class="fa fa-sort-desc" aria-hidden="true"></i></button>
                <div class="dropdown-content">
                    <a href="#" data-filter="all">All</a>
                    <a href="#" data-filter="dog">Dogs</a>
                    <a href="#" data-filter="cat">Cats</a>
                    <a href="#" data-filter="other">Others</a>
                </div>
            </div>            
        </div>
        
        <!-- Pet Cards -->
        <div class="grid">
            <% animals.forEach(animal => { %>
            <div class="pet" data-species="<%= animal.species.toLowerCase() %>"
                data-name="<%= animal.name.toLowerCase() %>"
                data-breed="<%= animal.breed.toLowerCase() %>"
                data-description="<%= animal.description.toLowerCase() %>">
                <div class="pet_image">
                    <img src="/images/pet_images/<%= animal.animal_id %>/profile.jpeg" alt="<%= animal.name %>" width="100" height="100">
                </div>
                <div class="pet_desc">
                    <h2><%= animal.name %></h2>
                    <hr>
                    <p><%= animal.description %></p>
                    <a href="/petDesc/<%= animal.animal_id %>"><button>Adopt Me</button></a>
                </div>
            </div>
            <% }); %>
        </div>
    </main>

    <script>
        //filter pets
        document.addEventListener('DOMContentLoaded', () => {
            const filterLinks = document.querySelectorAll('.dropdown-content a');
            const petCards = document.querySelectorAll('.pet');
    
            filterLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent page reload
                    const filter = link.getAttribute('data-filter'); // Get filter category
    
                    // Show/hide cards based on filter
                    petCards.forEach(card => {
                        if (filter === 'all' || card.getAttribute('data-species') === filter) {
                            card.style.display = 'block'; // Show card
                        } else {
                            card.style.display = 'none'; // Hide card
                        }
                    });
                });
            });
        });


        //Search Pets
        document.addEventListener('DOMContentLoaded', () => {
        const searchForm = document.getElementById('search-form');
        const searchInput = document.getElementById('search-input');
        const petCards = document.querySelectorAll('.pet');

        searchForm.addEventListener('submit', (event) => {
            event.preventDefault(); // Prevent form submission
            const query = searchInput.value.trim().toLowerCase(); // Get the search query

            petCards.forEach(card => {
                const name = card.getAttribute('data-name');
                const breed = card.getAttribute('data-species');
                const description = card.getAttribute('data-description');

                // Check if query matches name, breed, or description
                if (name.includes(query) || breed.includes(query) || description.includes(query)) {
                    card.style.display = 'block'; // Show matching card
                } else {
                    card.style.display = 'none'; // Hide non-matching card
                }
            });
        });
      });
    </script>
    
     <!-- FOOTER -->
    <%- include('partials/foot.ejs'); %>
</body>
</html>
