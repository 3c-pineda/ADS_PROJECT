<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/admin/mainAdminCss.css">
    <link rel="stylesheet" type="text/css" href="/admin/adminTableCss.css">
    <title>Admin - View Database</title>
</head>

<body>
     <!-- NAVIGATION BAR -->
     <%- include('adminPartials/adminNav.ejs', { activePage: 'home' }); %>
      
        <button id="restoreTable"><h2>></h2></button>
        <main>
            

            <!-- First Table with 19 headers -->
            <div class="titleContainer">
            <h1> SHELTER DATABASE</h1>
            </div>
            <div class="table-container">
               
                <table id="mainTable">
                    <thead>
                        <tr>
                            <th>Animals ID</th>
                            <th>Name</th>
                            <th>Species</th>
                            <th>Breed</th>
                            <th>Age</th>
                            <th>Sex</th>
                            <th>Characteristics</th>
                            <th>Health Status</th>
                            <th>Arrival Date</th>
                            <th>Adoption Status</th>
                            <th>Special Needs</th>
                            <th>Adoption Date</th>
                            <th>Birthday</th>
                            <th>Notes</th>
                            <th>Size</th>
                            <th>Location Rescued</th>
                            <th>Description</th>
                            <th>Is Desexed</th>
                            <th id="tableAction">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                            <% if (animals && animals.length > 0) { %>
                              <% animals.forEach(animal => { %>
                                <tr>
                                  <td><%= animal.animal_id %></td>
                                  <td><%= animal.name %></td>
                                  <td><%= animal.species %></td>
                                  <td><%= animal.breed %></td>
                                  <td><%= animal.age %></td>
                                  <td><%= animal.sex %></td>
                                  <td><%= animal.characteristics %></td>
                                  <td><%= animal.health_status %></td>
                                  <td><%= animal.arrival_date %></td>
                                  <td><%= animal.adoption_status %></td>
                                  <td><%= animal.special_needs %></td>
                                  <td><%= animal.adoption_date ? animal.adoption_date : 'N/A' %></td>
                                  <td><%= animal.birthday %></td>
                                  <td><%= animal.notes %></td>
                                  <td><%= animal.size %></td>
                                  <td><%= animal.location_rescued %></td>
                                  <td><%= animal.description %></td>
                                  <td><%= animal.is_desexed ? 'Yes' : 'No' %></td>
                                  <td>
                                    <div class="actionButtonContainer">
                                      <button onclick="redirectToViewWithId('<%= animal.id %>')" class="actionButtons">View</button>
                                      <button onclick="redirectToEditWithId('<%= animal.id %>')" class="actionButtons">Modify</button>
                                      <form action="/admin/adminDelete" method="POST">
                                        <input type="hidden" name="animal_id" value='<%= animal.animal_id %>'>
                                        <input type="hidden" name="animal_name" value='<%= animal.name %>'>
                                        <input type="hidden" name="method" value="POST">
                                        <button type="submit" class="actionButtons">Delete</button>
                                      </form>
                                    </div>
                                  </td>
                                </tr>
                              <% }); %>
                            <% } else { %>
                              <tr>
                                <td colspan="19">No animals found in the database.</td>
                              </tr>
                            <% } %>
                    </tbody>
                </table>
                    
            </div>
            <div class="navigation-buttons">
                <button id="prevHeaders"><<</button>
                <button id="nextHeaders">>></button>
            </div>
            <!-- Second Table with 4 headers -->
            <div class="titleContainer">
            <h1>SHELTER MEDICAL HISTORY DATABASE </h1>
            
            </div>
            <div class="second-table-container">
                <table id="secondTable">
                    <thead>
                        <tr>
                            <th>Vaccination Type</th>
                            <th>Vaccination Date</th>
                            <th>Vaccination Dose</th>
                            <th>Profile Picture</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Rabies</td>
                            <td>2003-03-09</td>
                            <td>2</td>
                            <td>[link_to_pic.jpg]</td>
                            <td>
                                <button onclick="redirectToViewWithId()" class="actionButtons">View</button>
                                <button onclick="redirectToEditWithId()" class="actionButtons">Modify</button>
                                <button onclick="redirectToDeleteWithId(id)" class="actionButtons">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Rabies</td>
                            <td>2024-06-09</td>
                            <td>1</td>
                            <td>[link_to_pic.jpg]</td>
                            <td>
                                <button onclick="redirectToViewWithId()" class="actionButtons">View</button>
                                <button onclick="redirectToEditWithId()" class="actionButtons">Modify</button>
                                <button onclick="redirectToDeleteWithId(id)" class="actionButtons">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>Pigeon Fox</td>
                            <td>2024-07-25</td>
                            <td>1</td>
                            <td>[link_to_pic.jpg]</td>
                            <td>
                                <button onclick="redirectToViewWithId()" class="actionButtons">View</button>
                                <button onclick="redirectToEditWithId()" class="actionButtons">Modify</button>
                                <button onclick="redirectToDeleteWithId(id)" class="actionButtons">Delete</button>
                            </td>
                        </tr>
                        <tr>
                            <td>FVRCP</td>
                            <td>2024-09-14</td>
                            <td>1</td>
                            <td>[link_to_pic.jpg]</td>
                            <td>
                                <button onclick="redirectToViewWithId()" class="actionButtons">View</button>
                                <button onclick="redirectToEditWithId()" class="actionButtons">Modify</button>
                                <button onclick="redirectToDeleteWithId(id)" class="actionButtons">Delete</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

        </main>
    </div>

    <script>
        function redirectToViewWithId(id) {
  location.href = http://localhost:3000/admin/adminView/${id};
}

function redirectToEditWithId(id) {
  location.href = http://localhost:3000/admin/adminEdit/${id};
}

function redirectToDeleteWithId(id) {
  location.href = http://localhost:3000/admin/adminDelete/${id};
}

        
        // Navigation for header buttons
        let currentStartIndex = 0;
        const headersToShow = 10;
        const totalHeaders = 19;

        const updateTableHeaders = () => {
            const headers = document.querySelectorAll('#mainTable thead tr th');
            const rows = document.querySelectorAll('#mainTable tbody tr');
            headers.forEach((header, index) => {
                if (index < currentStartIndex || index >= currentStartIndex + headersToShow) {
                    header.style.display = 'none';
                } else {
                    header.style.display = '';
                }
            });
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                cells.forEach((cell, index) => {
                    if (index < currentStartIndex || index >= currentStartIndex + headersToShow) {
                        cell.style.display = 'none';
                    } else {
                        cell.style.display = '';
                    }
                });
            });
        };

        document.getElementById('prevHeaders').addEventListener('click', () => {
            if (currentStartIndex > 0) {
                currentStartIndex -= headersToShow;
                updateTableHeaders();
            }
        });

        document.getElementById('nextHeaders').addEventListener('click', () => {
            if (currentStartIndex + headersToShow < totalHeaders) {
                currentStartIndex += headersToShow;
                updateTableHeaders();
            }
        });

        // Initial update
        updateTableHeaders();
    </script>
</body>
</html>
